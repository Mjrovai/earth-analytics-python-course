


<!doctype html>
<html lang="en" class="no-js">
  <head>
    


<meta charset="utf-8">




<!-- begin SEO -->









<title>Subtract One Raster from Another and Export a New Geotiff in Python | Earth Data Science - Earth Lab </title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Earth Data Science - Earth Lab">
<meta property="og:title" content="Subtract One Raster from Another and Export a New Geotiff in Python">


  <link rel="canonical" href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/">
  <meta property="og:url" content="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/">



  <meta content="Often you need to process two raster datasets together to create a new raster output. You then want to save that output as a new file. Learn how to subtract rasters and create a new geotiff file using open source Python." name="description">
  <meta property="og:description" content="Often you need to process two raster datasets together to create a new raster output. You then want to save that output as a new file. Learn how to subtract rasters and create a new geotiff file using open source Python.">


<!-- twitter cards -->

  <meta name="twitter:site" content="@earthlabcu">
  <meta name="twitter:title" content="Subtract One Raster from Another and Export a New Geotiff in Python">
  <meta name="twitter:description" content="Often you need to process two raster datasets together to create a new raster output. You then want to save that output as a new file. Learn how to subtract rasters and create a new geotiff file using open source Python.">
  <meta name="twitter:url" content="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/">

  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://earthdatascience.org/images/earth_sm_twit.png">
    <meta name="twitter:image:alt" content="The Earthlab Logo - image of a globe with courses, lessons and tutorials">

    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2018-02-05T00:00:00-07:00">
  
    <link rel="next" href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/classify-plot-raster-data-in-python/" title="Classify and Plot Raster Data in Python">
  
  
    <link rel="prev" href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/intro-to-the-geotiff-file-format/" title="About the Geotiff (.tif) Raster File Format: Raster Data in Python">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Earth Analytics",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Earth Data Science - Earth Lab Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="LfpevjsE0wlELv5KKOZv1T2RhRimGSiRckWv5ZC19GU" />
<!-- don't use the old cataloged meta tags -->
<meta name="googlebot" content="noodp">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>


<!-- For all browsers
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">-->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>


    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<!-- search bar begin  - turning off for now-->

<div class="search">
<form role="search" method="get" action="http://localhost:4000/search/">
    <input id="q" name="q"
           placeholder="Search earth data science site" type="text">
</form>
<!--<span class='cu-boulder'><a href="http://www.colorado.edu/earthlab" target="_blank">Earth Lab University of Colorado - Boulder Home </a></span> -->
</div>


<!-- search bar END -->

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/"><img src="/images/earth_sm.png" alt="Earth Lab - Earth Data Science" style="height:80%;width:85%"></a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tutorials/">Tutorials</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/courses/">Courses</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/workshops/">Workshops</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tools/">Tools</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/blog/">Blog</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/events/">Events</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/about/">About</a></li>
          

        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    











  
    










<nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs">
 <ol itemscope itemtype="http://schema.org/BreadcrumbList">
<a href="http://localhost:4000"></a>
 
 <!-- there is an offset of 1 so subtract 2 from the final crumb number-->
 
   
   
     <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
       <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
       <meta itemprop="position" content="" />
     </li>
     <span class="sep">/</span>
   
    
        <li><a href="http://localhost:4000/courses/">Courses </a>
        <span class="sep">/</span></li>
    
  
   
    
        <li><a href="http://localhost:4000/courses/earth-analytics-python/">Earth analytics python </a>
        <span class="sep">/</span></li>
    
  
   
    
        <li><a href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/"> Week 2.  Lidar raster data </a>
        <span class="sep">/</span></li>
    
  
   
    
        <li class="current">Subtract One Raster from Another and Export a New Geotiff in Python</li>
    
  
</ol>
</nav>

  


<div id="main" role="main">
  



  <div class="sidebar sticky">
  
  
    
      
      
      
    
    


    

    
     <!--  Might be able to delete this This is the code that populates the side bar navigation if there is a class-->
      





<!-- make sure we're only grabbing pages for the course -->



<!--<h3>Week 2 Lessons</h3>-->
<!-- i don't think the code below is used as modules is defined lower down as well. -->

<!-- This is how modules are sorted on the left hand side bar -->






<h5><a href="http://localhost:4000/courses/earth-analytics-python/" ><i class="fa fa-home" aria-hidden="true"></i> Earth-analytics-python Home</a></h5>

<!-- Just get the pages from this course -->






<nav class="nav__list">






<ul>
  <li><span class="nav__sub-title"><i class="fa fa-book" aria-hidden="true"></i> Units</span>
   <ul>
    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/python-open-science-toolbox/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       1. Get Started with Data in Python / Jupyter Notebooks</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    


      
       
        <li class='active-section'> <a href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/"><i class="fa fa-folder-open" aria-hidden="true"></i>
           2. LIDAR RASTER DATA IN PYTHON</a></li>
        

<div class='active-menu'>
      <ul>
        
        <!-- Note that class-order allows you to sort modules by class order if there are more than 1 in a class -->
        

        

        

        
        
          <li><span class="nav__sub-title grey"><i class="fa fa-caret-down" aria-hidden="true"></i> Intro to lidar data </span></li>
        <ul>

      
      <!-- count lessons -->

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/lidar-intro/><!--2.1 --> - Intro to Lidar Data</a></li>
          
          

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/explore-lidar-point-clouds-plasio/><!--2.2 --> - Explore Lidar Point Clouds</a></li>
          
          

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/lidar-chm-dem-dsm/><!--2.3 --> - CHM, DTM, DSM</a></li>
          
          

        
        
        

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/lidar-raster-data/><!--2.4 --> - Intro Lidar Raster Data</a></li>
          
          

        
        
        

        
        
        

        
        
        

        
        
        

        
       </ul>
        

        
        
          <li><span class="nav__sub-title grey"><i class="fa fa-caret-down" aria-hidden="true"></i> Lidar raster data in python </span></li>
        <ul>

      
      <!-- count lessons -->

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/open-lidar-raster-python/><!--2.1 --> - Open Raster Data Python</a></li>
          
          

        
        
        

        
        
        

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/raster-metadata-in-python/><!--2.2 --> - Raster Metadata</a></li>
          
          

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/plot-raster-histograms/><!--2.3 --> - Plot Raster Histograms</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/intro-to-the-geotiff-file-format/><!--2.4 --> - Geotiff File Format</a></li>
          
          

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/ class='active'> <!--2.5 -->- Subtract Rasters & Export Geotiffs</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/classify-plot-raster-data-in-python/><!--2.6 --> - Classify and Plot Raster</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/crop-raster-data-with-shapefile-in-python/><!--2.7 --> - Crop Raster Data</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/reproject-raster/><!--2.8 --> - Reproject Raster</a></li>
          
          

        
       </ul>
        

        
        
          <li><span class="nav__sub-title grey"><i class="fa fa-caret-down" aria-hidden="true"></i> Interactive maps </span></li>
        <ul>

      
      <!-- count lessons -->

        
        
        

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/overlay-raster-maps/><!--2.1 --> - Overlay Rasters</a></li>
          
          

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/interactive-maps/><!--2.2 --> - Interactive Maps</a></li>
          
          

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/customize-matplotlib-raster-maps/><!--2.3 --> - Custom Raster Maps</a></li>
          
          

        
        
        

        
        
        

        
        
        

        
        
        

        
        
        

        
        
        

        
        
        

        
       </ul>
        

        
      </ul>

      <!-- BEGIN Learn how to lessons -->
       <ul>
         
         
       </ul>


     </div>


      <!-- END BEGIN Learn how to lessons -->

      <!--  -->
      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/use-time-series-data-in-python/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       3. Time Series Data in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       4. Introduction to Shapefiles and Vector Data in Open Source Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/lidar-remote-sensing-uncertainty/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       5. Lidar Remote Sensing Uncertainty - Compare Ground to Lidar Measurements of Tree Height in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/multispectral-remote-sensing-in-python/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       7. Multispectral Imagery Python - NAIP, Landsat, Fire & Remote Sensing</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/multispectral-remote-sensing-modis/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       8. Quantify the Impacts of a Fire Using MODIS and Landsat Remote Sensing Data in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/contribute-to-open-source/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       9. You Can Contribute To Open Source Software Too! How to Get Started in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/create-efficient-data-workflows/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       10. Learn to Create Efficient Data Workflows in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/communicate-your-science/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       11. MidTerm Review - Science Communication</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/using-apis-natural-language-processing-twitter/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       13. Programmatic Data Access</a></li>
    


      

    
  </ul></li>
 </ul>


 <ul>
   <li><span class="nav__sub-title"><i class="fa fa-folder-open" aria-hidden="true"></i> Overview</span>
    <ul>
     
          
         <li> <a href="http://localhost:4000/courses/earth-analytics-python/">
           Earth Analytics Home </a></li>
         

     
          
         <li> <a href="http://localhost:4000/courses/earth-analytics-python/earth-analytics-syllabus/">
           Course Syllabus </a></li>
         

     
   </ul>
 </li>
</ul>
</nav>

<h5><a href="http://localhost:4000/courses/earth-analytics-python/" ><i class="fa fa-home" aria-hidden="true"></i> earth-analytics-python Home</a></h5>

    

    

  
  </div>






<!-- begin science / science themes side bar nav -->



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">

    <meta itemprop="headline" content="Subtract One Raster from Another and Export a New Geotiff in Python">
    <meta itemprop="description" content="Often you need to process two raster datasets together to create a new raster output. You then want to save that output as a new file. Learn how to subtract rasters and create a new geotiff file using open source Python.">
    <meta itemprop="datePublished" content="February 05, 2018">
    <meta itemprop="dateModified" content="October 08, 2018">

    <div class="page__inner-wrap">
      

        <header>
          <!-- BEGIN: insert a welcome to the module block on pages that are part of a module set -->

          <!-- END: insert welcome block -->
          <h1 class="page__title" itemprop="headline">
            Lesson 5. 
             Subtract One Raster from Another and Export a New Geotiff in Python
 </h1>
            
          

          
            <div class="page__meta">
              
              
              <a href="http://localhost:4000/authors/leah-wasser">Leah Wasser</a>, 
              
              
              <a href="http://localhost:4000/authors/chris-holdgraf">Chris Holdgraf</a>, 
              
              
              <a href="http://localhost:4000/authors/martha-morrissey">Martha Morrissey</a>
              
            </div>
          

        <br/>

        

          
        </header>
      

      <section class="page__content" itemprop="text">
        <!-- would like to include the TOC automatically but this does weird things-->
        
        <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-file-text"></i> In This Lesson</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#learning-objectives" id="markdown-toc-learning-objectives"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Learning Objectives</a></li>
  <li><a href="#what-you-need" id="markdown-toc-what-you-need"><i class="fa fa-check-square-o fa-2" aria-hidden="true"></i> What You Need</a></li>
  <li><a href="#canopy-height-model" id="markdown-toc-canopy-height-model">Canopy Height Model</a></li>
  <li><a href="#export-a-raster" id="markdown-toc-export-a-raster">Export a Raster</a></li>
  <li><a href="#optional-challenge" id="markdown-toc-optional-challenge"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Optional Challenge</a></li>
</ul>

  </nav>
</aside>

<div class="notice--success">

  <h2 id="learning-objectives"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Learning Objectives</h2>

  <p>After completing this tutorial, you will be able to:</p>
  <ul>
    <li>Derive a <strong>CHM</strong> in <code class="highlighter-rouge">Python</code> using raster math.</li>
  </ul>

  <h2 id="what-you-need"><i class="fa fa-check-square-o fa-2" aria-hidden="true"></i> What You Need</h2>

  <p>You will need a computer with internet access to complete this lesson and a working version of python version 3.x.
Your instructors recommend the Python Anaconda distribution.</p>

  <p><a href="https://ndownloader.figshare.com/files/12395030" data-proofer-ignore="" class="btn btn--success btn--x-large"><i class="fa fa-download" aria-hidden="true"></i> Download Colorado Flood Teaching Data Subset data</a></p>

</div>

<h3 id="be-sure-to-set-your-working-directory">Be sure to set your working directory</h3>
<p><code class="highlighter-rouge">os.chdir("path-to-you-dir-here/earth-analytics/data")</code></p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="n">rio</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">plotting_extent</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">earthpy</span> <span class="k">as</span> <span class="n">et</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Patch</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="n">colors</span>
<span class="kn">import</span> <span class="nn">earthpy.spatial</span> <span class="k">as</span> <span class="n">es</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="c"># Set plot parameters (optional)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="c"># prettier plotting with seaborn</span>

<span class="n">sns</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">"whitegrid"</span><span class="p">)</span>

<span class="c"># set working directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">et</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">HOME</span><span class="p">,</span> <span class="s">'earth-analytics'</span><span class="p">))</span>
</code></pre></div></div>

<p>Open and plot the lidar digital elevation model (DEM). Note that when you read the data, you can use the argument <code class="highlighter-rouge">masked = True</code> to ensure that the no data values do not plot and are assign <code class="highlighter-rouge">nan</code> or <code class="highlighter-rouge">nodata</code>.</p>

<!-- 
If we use masked=True we can skip this step
# Insert nans
#lidar_dem_im[lidar_dem_im == lidar_dem.nodata] = np.nan
-->

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># open raster data</span>
<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'data/colorado-flood/spatial/boulder-leehill-rd/pre-flood/lidar/pre_DTM.tif'</span><span class="p">)</span> <span class="k">as</span> <span class="n">lidar_dem</span><span class="p">:</span>
    <span class="n">lidar_dem_im</span> <span class="o">=</span> <span class="n">lidar_dem</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="c"># get bounds for plotting</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plotting_extent</span><span class="p">(</span><span class="n">lidar_dem</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="import-digital-surface-model-dsm">Import Digital Surface Model (DSM)</h3>

<p>Next, you will open the digital surface model (DSM). The DSM represents the top of
the earth’s surface. Thus, it includes trees, buildings and other objects that
sit on the earth.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'data/colorado-flood/spatial/boulder-leehill-rd/pre-flood/lidar/pre_DSM.tif'</span><span class="p">)</span> <span class="k">as</span> <span class="n">lidar_dsm</span><span class="p">:</span>
    <span class="n">lidar_dsm_im</span> <span class="o">=</span> <span class="n">lidar_dsm</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
<span class="n">lidar_dsm_im</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>masked_array(
  data=[[--, --, --, ..., 1695.6300048828125, 1695.5899658203125,
         1696.3900146484375],
        [--, --, --, ..., 1695.5999755859375, 1695.6300048828125, 1697.0],
        [--, --, --, ..., 1695.3800048828125, 1695.43994140625,
         1695.449951171875],
        ...,
        [--, --, --, ..., 1681.449951171875, 1681.3900146484375, 1681.25],
        [--, --, --, ..., 1681.719970703125, 1681.5699462890625,
         1681.5599365234375],
        [--, --, --, ..., 1681.8900146484375, 1681.8099365234375,
         1681.739990234375]],
  mask=[[ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        ...,
        [ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False]],
  fill_value=-3.402823e+38,
  dtype=float32)
</code></pre></div></div>

<h2 id="canopy-height-model">Canopy Height Model</h2>

<p>The canopy height model (CHM) represents the HEIGHT of the trees. This is not an elevation value, rather it’s the height or distance between the ground and the top of the trees (or buildings or whatever object that the lidar system detected and recorded).</p>

<p>Some canopy height models also include buildings, so you need to look closely at your data to make sure it was properly cleaned before assuming it represents all trees!</p>

<h3 id="calculate-difference-between-two-rasters">Calculate difference between two rasters</h3>

<p>There are different ways to calculate a CHM. One easy way is to subtract the
DEM from the DSM.</p>

<p><strong>DSM - DEM = CHM</strong></p>

<p>This math gives you the residual value or difference between the top of the
earth surface and the ground which should be the heights of the trees (and buildings
if the data haven’t been “cleaned”).</p>

<p class="notice--success"><i class="fa fa-star"></i> <strong>Data Tip:</strong> Note that this method of subtracting 2 rasters to create a CHM may not give you the most accurate results! There are better ways to create CHM’s using the point clouds themselves. However, in this lesson you learn this method as a means to get more familiar with the CHM dataset and to understand how to perform raster calculations in <code class="highlighter-rouge">Python</code>.</p>

<p>Before you subtract the two rasters, be sure to check to see if they cover the same area.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># are the bounds the same?</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Is the spatial extent the same?"</span><span class="p">,</span> <span class="n">lidar_dem</span><span class="o">.</span><span class="n">bounds</span> <span class="o">==</span> <span class="n">lidar_dsm</span><span class="o">.</span><span class="n">bounds</span><span class="p">),</span> 

<span class="c">## is the resolution the same ??</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Is the resolution the same?"</span><span class="p">,</span> <span class="n">lidar_dem</span><span class="o">.</span><span class="n">res</span> <span class="o">==</span> <span class="n">lidar_dsm</span><span class="o">.</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Is the spatial extent the same? True
Is the resolution the same? True
</code></pre></div></div>

<p>It looks like the bounds and resolution are the same. This means it is safe for you to subtract the two rasters without significant errors or uncertainty introduced.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># calculate canopy height model</span>
<span class="n">lidar_chm_im</span> <span class="o">=</span> <span class="n">lidar_dsm_im</span> <span class="o">-</span> <span class="n">lidar_dem_im</span>
</code></pre></div></div>

<p>Finally, plot your newly created canopy height model.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">chm_plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">lidar_chm_im</span><span class="p">,</span> 
                     <span class="n">cmap</span><span class="o">=</span><span class="s">'viridis'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">chm_plot</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=.</span><span class="mo">023</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Lidar Canopy Height Model (CHM)"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">();</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/02-intro-to-lidar-and-raster/lidar-raster-intro/2018-02-05-raster05-subtract-rasters_13_0.png" alt="A plot of a Lidar derived canopy height model for Lee Hill Road in Boulder, CO." />
<figcaption>A plot of a Lidar derived canopy height model for Lee Hill Road in Boulder, CO.</figcaption>

</figure>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lidar_chm_im</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> 
        <span class="n">color</span> <span class="o">=</span> <span class="s">'purple'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Histogram of CHM Values"</span><span class="p">);</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/02-intro-to-lidar-and-raster/lidar-raster-intro/2018-02-05-raster05-subtract-rasters_14_0.png" alt="A histogram of a Lidar derived canopy height model values for Lee Hill Road in Boulder, CO." />
<figcaption>A histogram of a Lidar derived canopy height model values for Lee Hill Road in Boulder, CO.</figcaption>

</figure>

<p>Take a close look at the CHM plot. Do you think that the data just represents trees? Or do you see anything that may suggest that there are other types of objects represented in the data?</p>

<h3 id="explore-the-chm-data">Explore the CHM Data</h3>

<p>Next, explore the data values in your CHM. Think about the values representing things like trees and buildings in your data.</p>

<p>Do the data make sense?</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'CHM minimum value: '</span><span class="p">,</span> <span class="n">lidar_chm_im</span><span class="o">.</span><span class="nb">min</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">'CHM max value: '</span><span class="p">,</span> <span class="n">lidar_chm_im</span><span class="o">.</span><span class="nb">max</span><span class="p">())</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CHM minimum value:  0.0
CHM max value:  26.930054
</code></pre></div></div>

<h2 id="export-a-raster">Export a Raster</h2>

<p>You can export a raster file in <code class="highlighter-rouge">python</code> using the <code class="highlighter-rouge">rasterio</code> <code class="highlighter-rouge">write()</code> function. Export the canopy height model that you just created to your data folder. You will create a new directory called “outputs” within the <code class="highlighter-rouge">colorado-flood</code> directory. This structure allows you to keep things organized, separating your outputs from the data you downloaded.</p>

<p>NOTE: you can use the code below to check for and create an outputs directory. OR, you can create the directory yourself using the finder (MAC) or windows
explorer.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s">'data/colorado-flood/spatial/outputs'</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'The directory exists!'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s">'data/colorado-flood/spatial/outputs'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The directory exists!
</code></pre></div></div>

<h3 id="exporting-numpy-arrays-to-geotiffs">Exporting Numpy Arrays to Geotiffs</h3>

<p>Next, you need to consider the metdata associated with your chm. Remember that the chm was generated using 2 numpy arrays. Neither of these arrays has spatial data directly associated with it. BUT you do have the rasterio object that has metadata that you can use if you want to assign all of the spatial attributes that are needed to save a usable geotiff file.</p>

<p>You can use the syntax</p>

<p><code class="highlighter-rouge">**dictionary-metadata-object-here</code></p>

<p>to apply all of the spatial attributes from one of your raster objects, when you write out your new chm raster.</p>

<p>To begin, have a look at the lidar_dem metadata dictionary. Looking at the example below, all of the metadata in that dictionary are the same as what we expect the output chm to have. Thus we can use the metadata as they are.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lidar_dem</span><span class="o">.</span><span class="n">meta</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'driver': 'GTiff',
 'dtype': 'float32',
 'nodata': -3.4028234663852886e+38,
 'width': 4000,
 'height': 2000,
 'count': 1,
 'crs': CRS({'init': 'epsg:32613'}),
 'transform': Affine(1.0, 0.0, 472000.0,
        0.0, -1.0, 4436000.0)}
</code></pre></div></div>

<p>Next, update the <code class="highlighter-rouge">nodata</code> value. The number being used currently is difficult to remember. A more standard value like <code class="highlighter-rouge">-999.99</code> could be a better option. To implement this we will do two things</p>

<ol>
  <li>You will assign all masked pixels values which represent <code class="highlighter-rouge">nodata</code> values to -999.99 using the <code class="highlighter-rouge">np.ma.filled()</code> function.</li>
  <li>Then you will create a new metadata dictionary that contained the updated nodata value.</li>
</ol>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lidar_chm_im</span><span class="o">.</span><span class="nb">min</span><span class="p">()</span>
<span class="n">lidar_chm_im</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>masked_array(
  data=[[--, --, --, ..., 0.0, 0.1700439453125, 0.9600830078125],
        [--, --, --, ..., 0.0, 0.090087890625, 1.6400146484375],
        [--, --, --, ..., 0.0, 0.0, 0.0799560546875],
        ...,
        [--, --, --, ..., 0.0, 0.0, 0.0],
        [--, --, --, ..., 0.0, 0.0, 0.0],
        [--, --, --, ..., 0.0, 0.0, 0.0]],
  mask=[[ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        ...,
        [ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False]],
  fill_value=-3.402823e+38,
  dtype=float32)
</code></pre></div></div>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># fill the masked pixels with a set no data value</span>
<span class="n">nodatavalue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">999.0</span>
<span class="n">lidar_chm_im_fi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">lidar_chm_im</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">nodatavalue</span><span class="p">)</span>
<span class="n">lidar_chm_im_fi</span><span class="o">.</span><span class="nb">min</span><span class="p">(),</span> <span class="n">nodatavalue</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(-999.0, -999.0)
</code></pre></div></div>

<p>Then update the metadata dictionary.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># update the metadata to ensure the nodata value is properly documented </span>

<span class="c"># create dictionary copy</span>
<span class="n">chm_meta</span> <span class="o">=</span> <span class="n">lidar_dem</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c"># update the nodata value to be an easier to use number</span>
<span class="n">chm_meta</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">'nodata'</span><span class="p">:</span> <span class="n">nodatavalue</span><span class="p">})</span>
<span class="n">chm_meta</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'driver': 'GTiff',
 'dtype': 'float32',
 'nodata': -999.0,
 'width': 4000,
 'height': 2000,
 'count': 1,
 'crs': CRS({'init': 'epsg:32613'}),
 'transform': Affine(1.0, 0.0, 472000.0,
        0.0, -1.0, 4436000.0)}
</code></pre></div></div>

<p>If you want, you can check things like the shape of the numpy array to ensure that it is the same as the width and height of the dem. It should be!</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># note the width and height of the dem above. Is the numpy array shape the same?</span>
<span class="n">lidar_chm_im_fi</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="output execute_result highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(2000, 4000)
</code></pre></div></div>

<p>Finally, you can export your raster layer. Below you do the following</p>

<ol>
  <li>you use the same <code class="highlighter-rouge">rio.open()</code> syntax that you are used to using except now you specify that you are writing a new file with the ‘w’ argument.</li>
  <li>you specify the new file name and destination in the <code class="highlighter-rouge">rio.open()</code> function eg: <code class="highlighter-rouge">'data/colorado-flood/spatial/outputs/lidar_chm.tiff'</code></li>
  <li>you specify the metadata as an “unpacked” dictionary using <code class="highlighter-rouge">**lidar_dem.meta</code> - doing this allows you to NOT have to specify EACH and EVERY metadata element individually in your output statement - which would be tedious!</li>
  <li>finally you write the file. <code class="highlighter-rouge">output_file.write(your-object-name, layer)</code>  Notice that when you make this call you specify both the object name and the layer that you wish to write to a new file. Also notice the <code class="highlighter-rouge">outf</code> is the name of the rasterio object as defined below.</li>
</ol>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">out_path</span> <span class="o">=</span> <span class="s">"data/colorado-flood/spatial/outputs/lidar_chm.tiff"</span>
<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="s">'w'</span><span class="p">,</span> <span class="o">**</span><span class="n">chm_meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">outf</span><span class="p">:</span>
    <span class="n">outf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lidar_chm_im_fi</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="notice--warning">

  <h2 id="optional-challenge"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Optional Challenge</h2>

  <p>Practice your skills. Open the lidar_chm geotiff file that you just created. 
Do the following:</p>

  <ol>
    <li>View the crs - is it correct?</li>
    <li>View the x and y spatial resolution.</li>
    <li>Plot the data using a color bar of your choice.</li>
  </ol>

  <p>Your plot should look like the one below (athough the colors may be different.</p>
</div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/02-intro-to-lidar-and-raster/lidar-raster-intro/2018-02-05-raster05-subtract-rasters_31_0.png" alt="Lidar canopy height model derived from the DTM and DSM." />
<figcaption>Lidar canopy height model derived from the DTM and DSM.</figcaption>

</figure>

<div class="notice--success">

  <p><i class="fa fa-star" aria-hidden="true"></i> <strong>Data Tip:</strong> You can simplify the directory code above by using the exclamation <code class="highlighter-rouge">not</code> which tells Python to return the INVERSE or opposite of the function you have requested Python to run.</p>
</div>

        

        <!-- if the page is a course lesson, add pagination -->

        
         <!-- This is clunky code that forces pagination across lesson sets -->
<!-- NOTE: it won't include slideshows as written which makes sense -->
<!-- add forced pagination -->
<!-- first, get total lesson count -->

<div class="previous--next">





<!-- if it's page one - then no previous button -->
<!-- how do i figure out the link? i have to loop through again? -->


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
       <a href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/classify-plot-raster-data-in-python/" class="btn btn--info btn--large btn-success" style="float:right" >
         Classify and Plot Raster
         <i class="fa fa-4 fa-arrow-circle-right" aria-hidden="true"></i></a>
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      
        <a href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/intro-to-the-geotiff-file-format/" class="btn btn--info btn--large btn-success">
          <i class="fa fa-4 fa-arrow-circle-left fa-4" aria-hidden="true"></i>
          Geotiff File Format </a>
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  

</div>

        
      </section>

      <footer class="page__meta">
        
        



  






  

  <i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags
  
  <span class="a-main-tag">
  <i class="fa fa-fw fa-tag" aria-hidden="true"></i><a href=http://localhost:4000/tags/reproducible-science-and-programming/>Reproducible science and programming</a>:
  </span>
  
    
    <a href=http://localhost:4000/tags/reproducible-science-and-programming/python/>python</a> 
    
    
  

  <span class="a-main-tag">
  <i class="fa fa-fw fa-tag" aria-hidden="true"></i><a href=http://localhost:4000/tags/remote-sensing/>Remote sensing</a>:
  </span>
  
    
    <a href=http://localhost:4000/tags/remote-sensing/lidar/>lidar</a> 
    
    
  

  <span class="a-main-tag">
  <i class="fa fa-fw fa-tag" aria-hidden="true"></i><a href=http://localhost:4000/tags/earth-science/>Earth science</a>:
  </span>
  
    
    <a href=http://localhost:4000/tags/earth-science/vegetation/>vegetation</a> 
    
    
  

  <span class="a-main-tag">
  <i class="fa fa-fw fa-tag" aria-hidden="true"></i><a href=http://localhost:4000/tags/spatial-data-and-gis/>Spatial data and gis</a>:
  </span>
  
    
    <a href=http://localhost:4000/tags/spatial-data-and-gis/raster-data/>raster data</a> 
    
    
  








        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-10-08">October 08, 2018</time></p>
        
      </footer>

      


<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/subtract-rasters-in-python/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
<br><br>
  <a href="http://bit.ly/2jc5SXy" target="_blank">
    <img src="http://localhost:4000/images/earth-data-analytics-professional-certificate-banner.png" alt="Get a professional Certificate in Earth Data Analytics at University of Colorado, Boulder" width="40%"></a>
</section>


       
    </div>

    
      


<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
    <div class="page__related">
      
        <h4 class="page__related-title">You May Also Enjoy</h4>
      
      <div class="grid__wrapper">
        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/data-wrangling/data-wrangling-numpy-arrays/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Data Wrangling With Numpy Arrays
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  6 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">This lesson teaches you how to wrangle data (e.g. run multi-task functions, combine) with numpy arrays.
</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/data-wrangling/data-wrangling-pandas/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Data Wrangling With Pandas
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  12 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">This lesson teaches you how to wrangle data (e.g. subselect, update, and combine) with pandas dataframes.
</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/prep-final-project/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Prepare For Final Project
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  less than 1 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">

     Today

  


</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/data-wrangling/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Data Wrangling
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  1 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">

     Today

  


</p>
    </article>
  </a>
</div>

        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->


<!-- Adding analytics code -->

        




  
     LINK HERE ea-python doi
     earth-analytics-python, earth-analytics-python
  


  



<div class="page__footer-follow">
  <ul class="social-icons">
    <li>
      <strong>&copy; 2018 Earth Lab -
      <a href="http://localhost:4000/license"> All materials on this site
        are subject to the CC BY-NC-ND 4.0 License. </a>
      </strong>
    </li>
  </ul>
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/earthlabcu"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/earthlab"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<!--
<div class="page__footer-copyright">Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
-->

      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'earthlabcu';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84081999-1', 'auto');
    ga('send', 'pageview');
</script>



  </body>
</html>

