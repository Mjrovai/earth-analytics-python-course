


<!doctype html>
<html lang="en" class="no-js">
  <head>
    


<meta charset="utf-8">




<!-- begin SEO -->









<title>Clip a spatial vector layer in python using shapely & geopandas: GIS in Python | Earth Data Science - Earth Lab </title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Earth Data Science - Earth Lab">
<meta property="og:title" content="Clip a spatial vector layer in python using shapely &amp; geopandas: GIS in Python">


  <link rel="canonical" href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/">
  <meta property="og:url" content="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/">



  <meta content="In this lesson you review how to clip a vector data layer in python using geopandas and shapely." name="description">
  <meta property="og:description" content="In this lesson you review how to clip a vector data layer in python using geopandas and shapely.">


<!-- twitter cards -->

  <meta name="twitter:site" content="@earthlabcu">
  <meta name="twitter:title" content="Clip a spatial vector layer in python using shapely &amp; geopandas: GIS in Python">
  <meta name="twitter:description" content="In this lesson you review how to clip a vector data layer in python using geopandas and shapely.">
  <meta name="twitter:url" content="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/">

  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://earthdatascience.org/images/earth_sm_twit.png">
    <meta name="twitter:image:alt" content="The Earthlab Logo - image of a globe with courses, lessons and tutorials">

    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2018-02-05T00:00:00-07:00">
  
    <link rel="next" href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/dissolve-polygons-in-python-geopandas-shapely/" title="How to Dissolve Polygons Using Geopandas: GIS in Python">
  
  
    <link rel="prev" href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/reproject-vector-data-in-python/" title="GIS in Python: Reproject Vector Data.">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Earth Analytics",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Earth Data Science - Earth Lab Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="LfpevjsE0wlELv5KKOZv1T2RhRimGSiRckWv5ZC19GU" />
<!-- don't use the old cataloged meta tags -->
<meta name="googlebot" content="noodp">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>


<!-- For all browsers
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">-->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>


    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<!-- search bar begin  - turning off for now-->

<div class="search">
<form role="search" method="get" action="http://localhost:4000/search/">
    <input id="q" name="q"
           placeholder="Search earth data science site" type="text">
</form>
<!--<span class='cu-boulder'><a href="http://www.colorado.edu/earthlab" target="_blank">Earth Lab University of Colorado - Boulder Home </a></span> -->
</div>


<!-- search bar END -->

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/"><img src="/images/earth_sm.png" alt="Earth Lab - Earth Data Science" style="height:80%;width:85%"></a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tutorials/">Tutorials</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/courses/">Courses</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/workshops/">Workshops</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tools/">Tools</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/blog/">Blog</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/events/">Events</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/about/">About</a></li>
          

        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    











  
    










<nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs">
 <ol itemscope itemtype="http://schema.org/BreadcrumbList">
<a href="http://localhost:4000"></a>
 
 <!-- there is an offset of 1 so subtract 2 from the final crumb number-->
 
   
   
     <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
       <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
       <meta itemprop="position" content="" />
     </li>
     <span class="sep">/</span>
   
    
        <li><a href="http://localhost:4000/courses/">Courses </a>
        <span class="sep">/</span></li>
    
  
   
    
        <li><a href="http://localhost:4000/courses/earth-analytics-python/">Earth analytics python </a>
        <span class="sep">/</span></li>
    
  
   
    
        <li><a href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/"> Week 4.  Spatial data vector shapefiles </a>
        <span class="sep">/</span></li>
    
  
   
    
        <li class="current">Clip a spatial vector layer in python using shapely & geopandas: GIS in Python</li>
    
  
</ol>
</nav>

  


<div id="main" role="main">
  



  <div class="sidebar sticky">
  
  
    
      
      
      
    
    


    

    
     <!--  Might be able to delete this This is the code that populates the side bar navigation if there is a class-->
      





<!-- make sure we're only grabbing pages for the course -->



<!--<h3>Week 4 Lessons</h3>-->
<!-- i don't think the code below is used as modules is defined lower down as well. -->

<!-- This is how modules are sorted on the left hand side bar -->






<h5><a href="http://localhost:4000/courses/earth-analytics-python/" ><i class="fa fa-home" aria-hidden="true"></i> Earth-analytics-python Home</a></h5>

<!-- Just get the pages from this course -->






<nav class="nav__list">






<ul>
  <li><span class="nav__sub-title"><i class="fa fa-book" aria-hidden="true"></i> Units</span>
   <ul>
    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/python-open-science-toolbox/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       1. Get Started with Data in Python / Jupyter Notebooks</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/lidar-raster-data/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       2. Lidar Raster Data in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/use-time-series-data-in-python/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       3. Time Series Data in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    


      
       
        <li class='active-section'> <a href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/"><i class="fa fa-folder-open" aria-hidden="true"></i>
           4. INTRODUCTION TO SHAPEFILES AND VECTOR DATA IN OPEN SOURCE PYTHON</a></li>
        

<div class='active-menu'>
      <ul>
        
        <!-- Note that class-order allows you to sort modules by class order if there are more than 1 in a class -->
        

        

        

        
        
          <li><span class="nav__sub-title grey"><i class="fa fa-caret-down" aria-hidden="true"></i> Spatial data in python </span></li>
        <ul>

      
      <!-- count lessons -->

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/intro-vector-data-python/><!--4.1 --> - Vector Data in Python</a></li>
          
          

        
        
        

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/intro-to-coordinate-reference-systems-python/><!--4.2 --> - Coordinate Reference Systems</a></li>
          
          

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/geographic-vs-projected-coordinate-reference-systems-python/><!--4.3 --> - Geographic vs projected CRS</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/epsg-proj4-coordinate-reference-system-formats-python/><!--4.4 --> - CRS: epsg vs proj.4</a></li>
          
          

        
        
        

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/reproject-vector-data-in-python/><!--4.5 --> - Reproject Vector Data</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/ class='active'> <!--4.6 -->- Clip Vector Data</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/dissolve-polygons-in-python-geopandas-shapely/><!--4.7 --> - Dissolve Polygons</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/spatial-joins-in-python-geopandas-shapely/><!--4.8 --> - Spatial Joins</a></li>
          
          

        
        
        
          
          <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/missing-data-vector-data-in-python/><!--4.9 --> - Missing spatial data</a></li>
          
          

        
       </ul>
        

        
      </ul>

      <!-- BEGIN Learn how to lessons -->
       <ul>
         
         

         
         
             <li><span class="nav__sub-title grey"><i class="fa fa-caret-down" aria-hidden="true"></i> Spatial data: custom plots in python </span></li>
             
             
         
         <ul>

         

       <!-- count lessons -->

         

         
         

         
         

         
         


           
           <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/python-customize-map-legends-geopandas/><!--4.1.1 --> - Customize Python Maps</a></li>
           
           
         

         
         


           
           <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/python-change-spatial-extent-of-map-matplotlib-geopandas/><!--4.1.2 --> - Adjust Map Extent</a></li>
           
           
         

         
         

         
         


           
           <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/python-for-loops-refresher/><!--4.1.3 --> - For Loop Refresher</a></li>
           
           
         

         
         

         
         

         
         


           
           <li><a href= http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/interactive-leaflet-maps-in-python-folium/><!--4.1.4 --> - Interactive leaflet maps</a></li>
           
           
         

         
         

         
         

         
         

         
         

         
         
        </ul>
         
       </ul>


     </div>


      <!-- END BEGIN Learn how to lessons -->

      <!--  -->
      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/lidar-remote-sensing-uncertainty/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       5. Lidar Remote Sensing Uncertainty - Compare Ground to Lidar Measurements of Tree Height in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/multispectral-remote-sensing-in-python/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       7. Multispectral Imagery Python - NAIP, Landsat, Fire & Remote Sensing</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/multispectral-remote-sensing-modis/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       8. Quantify the Impacts of a Fire Using MODIS and Landsat Remote Sensing Data in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/contribute-to-open-source/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       9. You Can Contribute To Open Source Software Too! How to Get Started in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/create-efficient-data-workflows/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       10. Learn to Create Efficient Data Workflows in Python</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/communicate-your-science/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       11. MidTerm Review - Science Communication</a></li>
    


      

    

    <!-- Only list the week if it's not the week for the current landing page -->
    
    <li> <a href="http://localhost:4000/courses/earth-analytics-python/using-apis-natural-language-processing-twitter/"> <!--<i class="fa fa-folder-o" aria-hidden="true"></i>-->
       13. Programmatic Data Access</a></li>
    


      

    
  </ul></li>
 </ul>


 <ul>
   <li><span class="nav__sub-title"><i class="fa fa-folder-open" aria-hidden="true"></i> Overview</span>
    <ul>
     
          
         <li> <a href="http://localhost:4000/courses/earth-analytics-python/">
           Earth Analytics Home </a></li>
         

     
          
         <li> <a href="http://localhost:4000/courses/earth-analytics-python/earth-analytics-syllabus/">
           Course Syllabus </a></li>
         

     
   </ul>
 </li>
</ul>
</nav>

<h5><a href="http://localhost:4000/courses/earth-analytics-python/" ><i class="fa fa-home" aria-hidden="true"></i> earth-analytics-python Home</a></h5>

    

    

  
  </div>






<!-- begin science / science themes side bar nav -->



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">

    <meta itemprop="headline" content="Clip a spatial vector layer in python using shapely &amp; geopandas: GIS in Python">
    <meta itemprop="description" content="In this lesson you review how to clip a vector data layer in python using geopandas and shapely.">
    <meta itemprop="datePublished" content="February 05, 2018">
    <meta itemprop="dateModified" content="October 23, 2018">

    <div class="page__inner-wrap">
      

        <header>
          <!-- BEGIN: insert a welcome to the module block on pages that are part of a module set -->

          <!-- END: insert welcome block -->
          <h1 class="page__title" itemprop="headline">
            Lesson 6. 
             Clip a spatial vector layer in python using shapely &amp; geopandas: GIS in Python
 </h1>
            
          

          
            <div class="page__meta">
              
              
              <a href="http://localhost:4000/authors/leah-wasser">Leah Wasser</a>, 
              
              
              <a href="http://localhost:4000/authors/martha-morrissey">Martha Morrissey</a>
              
            </div>
          

        <br/>

        

          
        </header>
      

      <section class="page__content" itemprop="text">
        <!-- would like to include the TOC automatically but this does weird things-->
        
        <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-file-text"></i> In This Lesson</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#learning-objectives" id="markdown-toc-learning-objectives"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Learning Objectives</a></li>
  <li><a href="#what-you-need" id="markdown-toc-what-you-need"><i class="fa fa-check-square-o fa-2" aria-hidden="true"></i> What You Need</a></li>
  <li><a href="#how-to-clip-vector-data-in-python" id="markdown-toc-how-to-clip-vector-data-in-python">How to Clip Vector Data in Python</a></li>
  <li><a href="#how-to-clip-shapefiles-in-python" id="markdown-toc-how-to-clip-shapefiles-in-python">How to Clip Shapefiles in Python</a></li>
  <li><a href="#clip-the-points-shapefile-in-python-using-geopandas" id="markdown-toc-clip-the-points-shapefile-in-python-using-geopandas">Clip The Points Shapefile in Python Using Geopandas</a></li>
  <li><a href="#crop-a-line-or-polygon-layer-to-an-extent" id="markdown-toc-crop-a-line-or-polygon-layer-to-an-extent">Crop a Line or Polygon Layer to An Extent</a></li>
  <li><a href="#how-to-clip-lines-and-polygons-in-python" id="markdown-toc-how-to-clip-lines-and-polygons-in-python">How to Clip Lines and Polygons in Python</a></li>
  <li><a href="#what-does-simplify-do" id="markdown-toc-what-does-simplify-do">What Does Simplify Do?</a></li>
</ul>

  </nav>
</aside>

<div class="notice--success">

  <h2 id="learning-objectives"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Learning Objectives</h2>

  <p>After completing this tutorial, you will be able to:</p>

  <ul>
    <li>Clip a spatial vector point and line layer to the spatial extent of a polygon layer in <code class="highlighter-rouge">Python</code> using geopandas.</li>
    <li>Plot data with custom legends</li>
  </ul>

  <h2 id="what-you-need"><i class="fa fa-check-square-o fa-2" aria-hidden="true"></i> What You Need</h2>

  <p>You will need a computer with internet access to complete this lesson and the
spatial-vector-lidar data subset created for the course.</p>

  <p><a href="https://ndownloader.figshare.com/files/12459464" data-proofer-ignore="" class="btn btn--success btn--x-large"><i class="fa fa-download" aria-hidden="true"></i> Download Spatial Lidar Teaching Data Subset data</a></p>

  <p>or using the <code class="highlighter-rouge">earthpy</code> package:</p>

  <p><code class="highlighter-rouge">et.data.get_data("spatial-vector-lidar")</code></p>

</div>

<p>In this lesson, you will learn how to spatially clip data for easier plotting and analysis of smaller spatial areas. You will use the <code class="highlighter-rouge">geopandas</code> library and the <code class="highlighter-rouge">box</code> module from the <code class="highlighter-rouge">shapely</code> library.</p>

<h2 id="how-to-clip-vector-data-in-python">How to Clip Vector Data in Python</h2>

<h3 id="what-is-clipping-or-cropping-data">What Is Clipping or Cropping Data?</h3>
<p>When you clip or crop spatial data you are removing the data outside of the clip extent. 
This means that your clipped dataset will be SMALLER (have a smaller spatial extent) than the original dataset.
This also means that objects in the data such as polygons or lines will be CUT based on the boundary of the clip object.</p>

<figure>
    <a href="/images/courses/earth-analytics/spatial-data/spatial-extent.png">
    <img src="/images/courses/earth-analytics/spatial-data/spatial-extent.png" alt="the spatial extent represents the spatial area that a particular dataset covers." /></a>
    <figcaption>The spatial extent of a shapefile or `Python` spatial object like a `geopandas` `geodataframe` represents
    the geographic "edge" or location that is the furthest north, south east and
    west. Thus is represents the overall geographic coverage of the spatial object.
    Image Source: National Ecological Observatory Network (NEON)
    </figcaption>
</figure>

<h3 id="when-do-you-want-to-clip-data">When Do You Want to Clip Data?</h3>
<p>You may want to clip your data for several reasons:</p>

<ol>
  <li>You have more data than you need. For example you have data outside of your study area that you don’t need to process. Clipping it to the study area boundary will make it smaller and easier to manage!</li>
  <li>If you have data outside of your study area and you clip it, you can perform analysis on only that region - thus you won’t need to subset the data further when you perform summary statistics for example.</li>
  <li>When you plot the data  you will only see the study region.</li>
</ol>

<p>You will learn how to both crop your data and zoom in on an extent below.<br />
Get started by loading your libraries. And be sure that your working directory is set.</p>

<p>In this lesson you will find examples of how to clip point and line data using geopandas. At the bottom of the lesson you will see a set of functions that can be used to clip the data in just one line of code. This lesson explains how those functions are built.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Import libraries</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="n">mlines</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="n">gpd</span>
<span class="c"># Load the box module from shapely to create box objects</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">box</span>
<span class="kn">import</span> <span class="nn">earthpy</span> <span class="k">as</span> <span class="n">et</span>
<span class="c"># Plot figures inline</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">et</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">HOME</span><span class="p">,</span> <span class="s">'earth-analytics'</span><span class="p">))</span>
<span class="c"># Import clip_data.py as a module so you can access the clip data functions</span>
<span class="kn">import</span> <span class="nn">clip_data</span> <span class="k">as</span> <span class="n">cl</span>
</code></pre></div></div>

<h2 id="how-to-clip-shapefiles-in-python">How to Clip Shapefiles in Python</h2>

<p>In your dataset for this week you have 3 layers:</p>

<ol>
  <li>A country boundary for the USA and</li>
  <li>A state boundary layer for the USA and</li>
  <li>Populated places in the USA</li>
</ol>

<p>The data are imported and plotted below. Notice that there are points outside of your study area which is the continental USA. Your goal is the clip the points out that you NEED for your project - the points that overlay on top of the continental United States.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Import all of your data at the top of your notebook to keep things organized.</span>
<span class="n">country_boundary_us</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span>
    <span class="s">'data/spatial-vector-lidar/usa/usa-boundary-dissolved.shp'</span><span class="p">)</span>
<span class="n">state_boundary_us</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span>
    <span class="s">'data/spatial-vector-lidar/usa/usa-states-census-2014.shp'</span><span class="p">)</span>
<span class="n">pop_places</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span>
    <span class="s">'data/spatial-vector-lidar/global/ne_110m_populated_places_simple/ne_110m_populated_places_simple.shp'</span><span class="p">)</span>

<span class="c"># Are the data all in the same crs?</span>
<span class="k">print</span><span class="p">(</span><span class="s">"country_boundary_us"</span><span class="p">,</span> <span class="n">country_boundary_us</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"state_boundary_us"</span><span class="p">,</span> <span class="n">state_boundary_us</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"pop_places"</span><span class="p">,</span> <span class="n">pop_places</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>country_boundary_us {'init': 'epsg:4326'}
state_boundary_us {'init': 'epsg:4326'}
pop_places {'init': 'epsg:4326'}
</code></pre></div></div>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">country_boundary_us</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
                         <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">state_boundary_us</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s">'Greys'</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pop_places</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/04-spatial-data/in-class/2018-02-05-spatial06-clip-vector-data-python_5_0.png" alt="Plot showing populated places for the entire globe overlayed on top of the Continental United States. If your study area is the USA, then you might not need all of the additional points. In this instance, you can clip or crop your data." />
<figcaption>Plot showing populated places for the entire globe overlayed on top of the Continental United States. If your study area is the USA, then you might not need all of the additional points. In this instance, you can clip or crop your data.</figcaption>

</figure>

<h2 id="clip-the-points-shapefile-in-python-using-geopandas">Clip The Points Shapefile in Python Using Geopandas</h2>

<p>To remove the points that are outside of your study area, you can clip the data. Removing or clipping data can make the data smaller and inturn plotting and analysis faster.</p>

<figure>
    <a href="/images/courses/earth-analytics/spatial-data/vector-clip.png">
    <img src="/images/courses/earth-analytics/spatial-data/vector-clip.png" alt="Clip vector data." /></a>
    <figcaption> When you clip a vector data set with another layer, you remove points, lines or polygons that are outside of the spatial extent of the area that you use to clip the data. This images shows a circular clip region - you will be using a rectangular region in this example. Image Source: ESRI
    </figcaption>
</figure>

<p>One way to clip a points layer is to:</p>

<ol>
  <li>Create a mask where every point that overlaps the polygon that you wish to clip to is set to true</li>
  <li>Apply that mask to filter the geopandas dataframe.</li>
</ol>

<p>To clip the data you first create a unified polygon object that represents the total area covered by your clip layer. If your study area contains only one polygon you can use <code class="highlighter-rouge">boundary.geometry[0]</code> to select the first (and only) polygon n the layer. You can also use <code class="highlighter-rouge">.unary_union</code> if you have many polygons in your clip boundary. <code class="highlighter-rouge">unary.union</code> will combine all of the polygons in your boundary layer into on vector object to use for clipping. Next you can use the <code class="highlighter-rouge">.intersects()</code> method to select just the points within the <code class="highlighter-rouge">pop_places</code> object that fall within the geometry in the <code class="highlighter-rouge">poly</code> object.</p>

<p>The <code class="highlighter-rouge">.intersects()</code> method returns a boolean mask. Every point that is within the poly object is set to <code class="highlighter-rouge">True</code>. Points that do not fall within the boundary are set to <code class="highlighter-rouge">False</code>. Finally, you subset the <code class="highlighter-rouge">pop_places</code> object</p>

<p><code class="highlighter-rouge">pop_places[pop_places.geometry.intersects(poly)]</code></p>

<p>What will be returned are just the points that fall within the polygon region.</p>

<p>The process for clipping points, lines and polygons is different. However, to streamline things, for this class, your instructor has created a <code class="highlighter-rouge">clip_shp()</code> function that you imported above as a module to use in this lesson.</p>

<p><code class="highlighter-rouge">import clip_data</code></p>

<p>If you wanted to clip data using geopandas you use the <code class="highlighter-rouge">.intersection()</code> method as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># "clip" a points layer to the boundary of a polygon</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">country_boundary_us</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span>
<span class="n">points_clip</span> <span class="o">=</span> <span class="n">pop_places</span><span class="p">[</span><span class="n">pop_places</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">poly</span><span class="p">)]</span>
</code></pre></div></div>

<p>However if you use the <code class="highlighter-rouge">clip_shp()</code> shape function, it will take care of all of these steps for you.
Clip shape takes two arguments:</p>

<ul>
  <li>shp: the vector layer (point, line or polygon) that you wish to clip and</li>
  <li>clip_obj: the polygon that you wish to use to clip your data</li>
</ul>

<p><code class="highlighter-rouge">clip_shp()</code> will clip the data to the boundary of the polygon layer that ou select. If there are multiple polygons in your clip_obj object, <code class="highlighter-rouge">clip_shp()</code> will clip the data to the total boundary of all polygons in the layer.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Clip the data using the clip_data module</span>
<span class="n">points_clip</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">clip_shp</span><span class="p">(</span><span class="n">pop_places</span><span class="p">,</span> <span class="n">country_boundary_us</span><span class="p">)</span>
<span class="c"># View the first 6 rows and a few select columns</span>
<span class="n">points_clip</span><span class="p">[[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'geometry'</span><span class="p">,</span> <span class="s">'scalerank'</span><span class="p">,</span> <span class="s">'natscale'</span><span class="p">,</span> <span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="output execute_result">
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>geometry</th>
      <th>scalerank</th>
      <th>natscale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>175</th>
      <td>San Francisco</td>
      <td>POINT (-122.4171687735522 37.76919562968743)</td>
      <td>1</td>
      <td>300</td>
    </tr>
    <tr>
      <th>176</th>
      <td>Denver</td>
      <td>POINT (-104.9859618109682 39.7411339069655)</td>
      <td>1</td>
      <td>300</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Houston</td>
      <td>POINT (-95.34192514914599 29.82192024318886)</td>
      <td>1</td>
      <td>300</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Miami</td>
      <td>POINT (-80.22605193945003 25.78955655502153)</td>
      <td>1</td>
      <td>300</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Atlanta</td>
      <td>POINT (-84.40189524187565 33.83195971260585)</td>
      <td>1</td>
      <td>300</td>
    </tr>
  </tbody>
</table>
</div>

<p>Now you can plot the data to see the newly “clipped” points layer.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">country_boundary_us</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="s">"white"</span><span class="p">,</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s">"black"</span><span class="p">,</span>
                         <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">state_boundary_us</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s">'Greys'</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">points_clip</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                 <span class="n">column</span><span class="o">=</span><span class="s">'name'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>

<span class="c"># Label each point - note this is just shown here optionally but is not required for your homework</span>
<span class="n">points_clip</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s">'name'</span><span class="p">],</span>
                                        <span class="n">xy</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s">"offset points"</span><span class="p">,</span>
                                        <span class="n">backgroundcolor</span><span class="o">=</span><span class="s">"white"</span><span class="p">),</span>
                  <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/04-spatial-data/in-class/2018-02-05-spatial06-clip-vector-data-python_9_0.png" alt="Once you have clipped the points layer to your USA extent, you have fewer points to work with. This will make processing your data more efficient." />
<figcaption>Once you have clipped the points layer to your USA extent, you have fewer points to work with. This will make processing your data more efficient.</figcaption>

</figure>

<h2 id="crop-a-line-or-polygon-layer-to-an-extent">Crop a Line or Polygon Layer to An Extent</h2>

<p>The process for clipping a line or polygon layer is slightly different than clipping a set of points. To clip a line of polygon feature you will do the following:</p>

<ol>
  <li>Ensure that your polygon and line layer are in the same coordinate reference system</li>
  <li>Identify what features in the lines layer fall WITHIN the boundary of the polygon layer</li>
  <li>Subset the features within the geometry and reset the geometry of the newly clipped layer to be equal to the clipped data.</li>
</ol>

<p>This last step may seem unusual. When you clip data using shapely and geopandas the default behaviour is for it to only return the clipped geometry. However you may with to also retain the attributes associated with the geometry. This is where the <code class="highlighter-rouge">set_geometry()</code> methods comes into play.</p>

<p>For this example you will use the <code class="highlighter-rouge">country_boundary</code> layer and a clipped version of the natural earth 10m roads layer. * Import <code class="highlighter-rouge">ne_10m_n_america_roads.shp</code> into python.</p>
<ul>
  <li>Next, check to ensure that the roads and country boundary are in the same CRS. You may need to reproject the data.</li>
  <li>Because spatial operations take time, it’s best if you subset your data as much as possible prior to clipping.</li>
</ul>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Open the roads layer</span>
<span class="n">ne_roads</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span>
    <span class="s">'data/spatial-vector-lidar/global/ne_10m_roads/ne_10m_roads.shp'</span><span class="p">)</span>
<span class="c"># Are both layers in the same CRS?</span>

<span class="k">if</span> <span class="p">(</span><span class="n">ne_roads</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="n">country_boundary_us</span><span class="o">.</span><span class="n">crs</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Both layers are in the same crs!"</span><span class="p">,</span>
          <span class="n">ne_roads</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">country_boundary_us</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Both layers are in the same crs! {'init': 'epsg:4326'} {'init': 'epsg:4326'}
</code></pre></div></div>

<h2 id="how-to-clip-lines-and-polygons-in-python">How to Clip Lines and Polygons in Python</h2>

<p>In your dataset for this week you have 2 layers.</p>

<ol>
  <li>A global, natural earth roads layer and</li>
  <li>A boundary for the United States.</li>
</ol>

<p>The roads data are imported below. You imported the boundary layer above.</p>

<p>If both layers are in the same CRS, you are ready to clip your data. Because the clip functions are new and little testing has been done with them, you will see all of the lines of code required to clip your data. However you can use the <code class="highlighter-rouge">clip_shp()</code> function to clip your data for this week’s class!</p>

<p>Be patient while your clip code below runs.</p>

<p>To make your code run faster, you can simplify the geometry of your country boundary. Simplify should be used with caution as it does modify your data.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Simplify the geometry of the clip extent for faster processing</span>
<span class="c"># Use this with caution as it modifies your data.</span>
<span class="n">country_boundary_us_sim</span> <span class="o">=</span> <span class="n">country_boundary_us</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span>
    <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">preserve_topology</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Clip and plot the data. Be patient. It may take up to a minute to clip the data.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ne_roads_clip</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">clip_shp</span><span class="p">(</span><span class="n">ne_roads</span><span class="p">,</span> <span class="n">country_boundary_us_sim</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The clipped data have fewer line objects (represented by rows):"</span><span class="p">,</span>
      <span class="n">ne_roads_clip</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ne_roads</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The clipped data have fewer line objects (represented by rows): (7346, 32) (56601, 32)
</code></pre></div></div>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ne_roads</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ne_roads_clip</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Unclipped roads"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Clipped roads"</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/04-spatial-data/in-class/2018-02-05-spatial06-clip-vector-data-python_18_0.png" alt="Clipped vs unclipped roads layer. " />
<figcaption>Clipped vs unclipped roads layer. </figcaption>

</figure>

<p>Plot the cropped data.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">country_boundary_us</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="s">"white"</span><span class="p">,</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s">"black"</span><span class="p">,</span>
                         <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ne_roads_clip</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/04-spatial-data/in-class/2018-02-05-spatial06-clip-vector-data-python_20_0.png" alt="Final plot showing the clipped roads drawn on top of the country boundary. Notice that there are no road segments outside of the country boundary." />
<figcaption>Final plot showing the clipped roads drawn on top of the country boundary. Notice that there are no road segments outside of the country boundary.</figcaption>

</figure>

<div class="notice">
  <p><i class="fa fa-star"></i><strong>How Clip_shp() works:</strong></p>

  <p>Here are the steps involved with clipping data in geopandas - these steps are completed when you use the <code class="highlighter-rouge">clip_shp()</code> function which is provided to you as a <code class="highlighter-rouge">.py</code> script that you can import into this lesson as a module. They are simply described below just in case you ever need to clip data in python and that function doesn’t work for you.</p>

  <ol>
    <li>Subset the roads data using a spatial index.</li>
    <li>Clip the geometry using <code class="highlighter-rouge">.intersection()</code></li>
    <li>Remove all rows in the geodataframe that have no geometry (this is explained below).</li>
    <li>Update the original roads layer to contained only the clipped geometry</li>
  </ol>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a single polygon object for clipping</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">clip_obj</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span>
<span class="n">spatial_index</span> <span class="o">=</span> <span class="n">shp</span><span class="o">.</span><span class="n">sindex</span>

<span class="c"># Create a box for the initial intersection</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">bounds</span>
<span class="c"># Get a list of id's for each road line that overlaps the bounding box and subset the data to just those lines</span>
<span class="n">sidx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spatial_index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">bbox</span><span class="p">))</span>
<span class="n">shp_sub</span> <span class="o">=</span> <span class="n">shp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sidx</span><span class="p">]</span>

<span class="c"># Clip the data - with these data</span>
<span class="n">clipped</span> <span class="o">=</span> <span class="n">shp_sub</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">clipped</span><span class="p">[</span><span class="s">'geometry'</span><span class="p">]</span> <span class="o">=</span> <span class="n">shp_sub</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

<span class="c"># Return the clipped layer with no null geometry values</span>
<span class="n">final_clipped</span> <span class="o">=</span> <span class="n">clipped</span><span class="p">[</span><span class="n">clipped</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
</code></pre></div>  </div>
</div>

<h2 id="what-does-simplify-do">What Does Simplify Do?</h2>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c"># a larger tolerance yields a blockier polygon</span>
<span class="n">country_boundary_us</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">preserve_topology</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

<span class="c"># a larger tolerance yields a blockier polygon</span>
<span class="n">country_boundary_us</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">preserve_topology</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s">"Data with a higher tolerance value will become visually blockier as there are fewer vertices"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s">"Data with a very low tolerance value will look smoother but will take longer to process"</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/04-spatial-data/in-class/2018-02-05-spatial06-clip-vector-data-python_23_0.png" alt="Simplify removes vertices or points from a complex object effectively smoothing the data. Use this method with caution as it will impact any outcome statistics of your data." />
<figcaption>Simplify removes vertices or points from a complex object effectively smoothing the data. Use this method with caution as it will impact any outcome statistics of your data.</figcaption>

</figure>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Plot the data by attribute</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">country_boundary_us</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                         <span class="n">color</span><span class="o">=</span><span class="s">"white"</span><span class="p">,</span> 
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s">"black"</span><span class="p">,</span> 
                         <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ne_roads_clip</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                   <span class="n">column</span><span class="o">=</span><span class="s">'type'</span><span class="p">,</span> 
                   <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/04-spatial-data/in-class/2018-02-05-spatial06-clip-vector-data-python_24_0.png" alt="The final clipped roads layer. When you use the default pandas plotting, your legend will have circles for each attribute type. If you want to represent line data using lines in the legend, then you will need to create a custom plot and legend as demonstrated below." />
<figcaption>The final clipped roads layer. When you use the default pandas plotting, your legend will have circles for each attribute type. If you want to represent line data using lines in the legend, then you will need to create a custom plot and legend as demonstrated below.</figcaption>

</figure>

<p>Below, you create a custom legend. There are many different approaches to this. One is below.</p>

<p>To begin you create a python dictionary for each attribute value in your legend. Below you will see each road type has a dictionary entry and two associated values - a color and a number representing the width of the line in your legend.</p>

<p><code class="highlighter-rouge">'Beltway': ['black', 2]</code> Color the line for beltway black with a line width of 2.</p>

<p>Next you loop through the dictionary to plot the data. In the loop below, you select each attribute value, and plot it using the color and line width assigned in the dictionary above.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">ctype</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ne_roads_clip</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'type'</span><span class="p">):</span>
    <span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">road_attrs</span><span class="p">[</span><span class="n">ctype</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
              <span class="n">label</span><span class="o">=</span><span class="n">ctype</span><span class="p">,</span>
              <span class="n">linewidth</span><span class="o">=</span><span class="n">road_attrs</span><span class="p">[</span><span class="n">ctype</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></div>
<p>Finally, a call to <code class="highlighter-rouge">ax.legend()</code> renders the legend using the colors applied in the loop above.</p>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Plot with a custom legend</span>

<span class="c"># First, create a dictionary with the attributes of each legend item</span>
<span class="n">road_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Beltway'</span><span class="p">:</span> <span class="p">[</span><span class="s">'black'</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="s">'Secondary Highway'</span><span class="p">:</span> <span class="p">[</span><span class="s">'grey'</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">],</span>
              <span class="s">'Road'</span><span class="p">:</span> <span class="p">[</span><span class="s">'grey'</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">],</span>
              <span class="s">'Bypass'</span><span class="p">:</span> <span class="p">[</span><span class="s">'grey'</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">],</span>
              <span class="s">'Ferry Route'</span><span class="p">:</span> <span class="p">[</span><span class="s">'grey'</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">],</span>
              <span class="s">'Major Highway'</span><span class="p">:</span> <span class="p">[</span><span class="s">'black'</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>

<span class="c"># plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ctype</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ne_roads_clip</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'type'</span><span class="p">):</span>
    <span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">road_attrs</span><span class="p">[</span><span class="n">ctype</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
              <span class="n">label</span><span class="o">=</span><span class="n">ctype</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
              <span class="n">linewidth</span><span class="o">=</span><span class="n">road_attrs</span><span class="p">[</span><span class="n">ctype</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

<span class="n">country_boundary_us</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"white"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">"black"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"United States Roads by Type"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<figure class="output display_data">

<img src="http://localhost:4000//images/courses/earth-analytics-python/04-spatial-data/in-class/2018-02-05-spatial06-clip-vector-data-python_26_0.png" alt="Currently geopandas does not support too much customization of plot legends. Thus if you want to create a custom legend, you will need to create a dictionary of colors and other legend attributes that you'll need to create the custom legend." />
<figcaption>Currently geopandas does not support too much customization of plot legends. Thus if you want to create a custom legend, you will need to create a dictionary of colors and other legend attributes that you'll need to create the custom legend.</figcaption>

</figure>

<div class="language-python input highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create function to clip point data using geopandas</span>


<span class="k">def</span> <span class="nf">clip_points</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="n">clip_obj</span><span class="p">):</span>
    <span class="s">'''
    Docs Here
    '''</span>

    <span class="n">poly</span> <span class="o">=</span> <span class="n">clip_obj</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span>
    <span class="k">return</span><span class="p">(</span><span class="n">shp</span><span class="p">[</span><span class="n">shp</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">poly</span><span class="p">)])</span>

<span class="c"># Create function to clip line and polygon data using geopandas</span>


<span class="k">def</span> <span class="nf">clip_line_poly</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="n">clip_obj</span><span class="p">):</span>
    <span class="s">'''
    docs
    '''</span>

    <span class="c"># Create a single polygon object for clipping</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">clip_obj</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span>
    <span class="n">spatial_index</span> <span class="o">=</span> <span class="n">shp</span><span class="o">.</span><span class="n">sindex</span>

    <span class="c"># Create a box for the initial intersection</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">bounds</span>
    <span class="c"># Get a list of id's for each road line that overlaps the bounding box and subset the data to just those lines</span>
    <span class="n">sidx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spatial_index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">bbox</span><span class="p">))</span>
    <span class="n">shp_sub</span> <span class="o">=</span> <span class="n">shp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sidx</span><span class="p">]</span>

    <span class="c"># Clip the data - with these data</span>
    <span class="n">clipped</span> <span class="o">=</span> <span class="n">shp_sub</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">clipped</span><span class="p">[</span><span class="s">'geometry'</span><span class="p">]</span> <span class="o">=</span> <span class="n">shp_sub</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

    <span class="c"># Return the clipped layer with no null geometry values</span>
    <span class="k">return</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="n">clipped</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">notnull</span><span class="p">()])</span>


<span class="c"># Final clip function that handles points, lines and polygons</span>


<span class="k">def</span> <span class="nf">clip_shp</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="n">clip_obj</span><span class="p">):</span>
    <span class="s">'''
    '''</span>
    <span class="k">if</span> <span class="n">shp</span><span class="p">[</span><span class="s">"geometry"</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="nb">type</span> <span class="o">==</span> <span class="s">"Point"</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">clip_points</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="n">clip_obj</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">clip_line_poly</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="n">clip_obj</span><span class="p">))</span>
</code></pre></div></div>

        

        <!-- if the page is a course lesson, add pagination -->

        
         <!-- This is clunky code that forces pagination across lesson sets -->
<!-- NOTE: it won't include slideshows as written which makes sense -->
<!-- add forced pagination -->
<!-- first, get total lesson count -->

<div class="previous--next">





<!-- if it's page one - then no previous button -->
<!-- how do i figure out the link? i have to loop through again? -->


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
       <a href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/dissolve-polygons-in-python-geopandas-shapely/" class="btn btn--info btn--large btn-success" style="float:right" >
         Dissolve Polygons
         <i class="fa fa-4 fa-arrow-circle-right" aria-hidden="true"></i></a>
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      
        <a href="http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/reproject-vector-data-in-python/" class="btn btn--info btn--large btn-success">
          <i class="fa fa-4 fa-arrow-circle-left fa-4" aria-hidden="true"></i>
          Reproject Vector Data </a>
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    

    
      

      
      
    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  
      
    


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  
      
    


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  


    
  
  <!-- ELSE if it's a module -->
  

</div>

        
      </section>

      <footer class="page__meta">
        
        







        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-10-23">October 23, 2018</time></p>
        
      </footer>

      


<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/courses/earth-analytics-python/spatial-data-vector-shapefiles/clip-vector-data-in-python-geopandas-shapely/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
<br><br>
  <a href="http://bit.ly/2jc5SXy" target="_blank">
    <img src="http://localhost:4000/images/earth-data-analytics-professional-certificate-banner.png" alt="Get a professional Certificate in Earth Data Analytics at University of Colorado, Boulder" width="40%"></a>
</section>


       
    </div>

    
      


<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
    <div class="page__related">
      
        <h4 class="page__related-title">You May Also Enjoy</h4>
      
      <div class="grid__wrapper">
        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/data-wrangling/data-wrangling-numpy-arrays/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Data Wrangling With Numpy Arrays
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  6 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">This lesson teaches you how to wrangle data (e.g. run multi-task functions, combine) with numpy arrays.
</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/data-wrangling/data-wrangling-pandas/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Data Wrangling With Pandas
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  12 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">This lesson teaches you how to wrangle data (e.g. subselect, update, and combine) with pandas dataframes.
</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/prep-final-project/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Prepare For Final Project
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  less than 1 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">

     Today

  


</p>
    </article>
  </a>
</div>

        
          




<div class="grid__item">
  
    <a href="http://localhost:4000/courses/earth-analytics-bootcamp/data-wrangling/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Data Wrangling
</h2>


     
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  1 minute read
	
</p>
      
      <p class="archive__item-excerpt" itemprop="description">

     Today

  


</p>
    </article>
  </a>
</div>

        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->


<!-- Adding analytics code -->

        




  
     LINK HERE ea-python doi
     earth-analytics-python, earth-analytics-python
  


  



<div class="page__footer-follow">
  <ul class="social-icons">
    <li>
      <strong>&copy; 2018 Earth Lab -
      <a href="http://localhost:4000/license"> All materials on this site
        are subject to the CC BY-NC-ND 4.0 License. </a>
      </strong>
    </li>
  </ul>
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/earthlabcu"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/earthlab"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<!--
<div class="page__footer-copyright">Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
-->

      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'earthlabcu';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-84081999-1', 'auto');
    ga('send', 'pageview');
</script>



  </body>
</html>

